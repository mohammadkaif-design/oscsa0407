#include <stdio.h>
#include <pthread.h>
#include <semaphore.h>

sem_t chopstick[5];
void* dine(void* n){
    int i = (int)n;
    sem_wait(&chopstick[i]);
    sem_wait(&chopstick[(i+1)%5]);
    printf("Philosopher %d is eating\n", i);
    sem_post(&chopstick[i]);
    sem_post(&chopstick[(i+1)%5]);
}
int main(){
    pthread_t t[5]; int i,a[5];
    for(i=0;i<5;i++) sem_init(&chopstick[i],0,1);
    for(i=0;i<5;i++){ a[i]=i; pthread_create(&t[i],0,dine,&a[i]); }
    for(i=0;i<5;i++) pthread_join(t[i],0);
}
